# 塔防项目初始对话与需求汇总（2025-08-20）

本文档整理当前对话内容，归纳项目的已确定需求、范围界定与开放问题，作为后续迭代的统一依据。

## 基本信息
- Unity 版本：2021.3.1f1c1
- 渲染管线：Built-in（内置管线）
- 项目类型：3D
- 目标平台：
  - 当前：PC（横屏）
  - 未来：Android（横屏）
- 性能目标：≥ 60 FPS
- UI 框架：UGUI
- 输入：暂不做特定要求（按需）
- 测试 / CI：暂不考虑
- 多语言 / 存档：暂不考虑

## 核心玩法与世界
- 地图与布局：可考虑基于方块网格（格子大小不固定）。
- 敌人移动：暂不做通用寻路；敌方沿预设路径（Path）行进。
- 建造：玩家在路径上搭建防御塔来攻击敌人。
- 首发塔：3 个塔型。
- 攻击形态：初期统一为“子弹型投射物”，后续可拓展（射线、范围、光束等）。
- 元素体系：金木水火土；示例克制关系为“金克木，木克水，…，土克金”。
- 关卡：固定关卡（暂不做关卡编辑器）。
- 资源：暂无美术资源，初期用 Unity 内置 3D Primitive 占位。
- 资源管理：使用对象池（Pooling）。

## 数据与配置
- 配置载体：不使用 ScriptableObject，统一使用 JSON。
  - 涵盖：塔、敌人、关卡、元素伤害/抗性、平衡参数等。

## 代码与架构约定（后续将补充到 CodingStandards.md）
- GameObject 只承载生命周期函数与最薄逻辑；核心逻辑在纯 C# 类中实现。
- 使用接口与多态，必要时通过 partial 将大类拆分为多个文件。
- 公共与通用函数沉淀到 Common/Utilities 目录。
- 每个类保持简洁，并附带 XML 注释与对应的 .md 说明文件（按需）。
- 目录建议（待创建）：
  - Assets/Scripts
    - Common（对象池、计时器、事件、服务容器、接口）
    - Core（启动、生命周期驱动、场景装配）
    - Gameplay（塔/敌人/投射物/路径/波次/伤害/目标选择）
    - UI（HUD、建造、通用界面）
    - Config（JSON 读写与数据模型）
  - Assets/Docs（规范、进度、架构、类说明）

## 待明确 / 开放问题
- 网格与建造：
  - 格子坐标系与单位大小的确定方式？是否支持不同关卡自定义格子大小？
  - “在路径上建塔”是否意味着阻断路径的风险与规则（允许/禁止阻断）？
  - 塔的摆放是否完全贴合路径曲线，或仅限路径节点/离散格位？
- 路径表达：采用 Waypoints（样条/折线）？路径数据的 JSON 结构约定？
- 元素克制：
  - 是否需要完整环：金→木→水→火→土→金？是否包含相生/抗性数值？
  - 伤害公式：元素克制系数、暴击、穿透等是否需要首发定义？
- 敌人波次：
  - 固定关卡的波次脚本规则（时间、数量、类型、间隔）？
- 性能约束：
  - PC/Android 的最小/目标配置（影响粒度、碰撞、对象池规模等）？
- JSON 管理：
  - 热更新/重新加载的需求？存储位置（StreamingAssets/可写路径）与加密/校验？

## 近期建议的最小实现（仅供排期参考）
1) 文档与规范：创建 Docs 目录与 CodingStandards.md、Progress.md 骨架。
2) 核心框架：
   - GameBootstrapper（MonoBehaviour，最薄生命周期）
   - ServiceContainer（服务定位/轻量 DI）
   - UpdateDriver（集中驱动 IUpdatable/ILateUpdatable/IFixedUpdatable）
3) 通用：
   - 对象池（泛型池 + 预热）
   - JSON 序列化工具（Newtonsoft 或 Unity 内置 JsonUtility + 自定义扩展）
4) Gameplay 初版：
   - Path/Waypoint 数据结构与简单路径跟随组件
   - 塔基放置规则（基于路径的离散点或格位）
   - 敌人简易移动与生命/伤害接口
   - 子弹型投射物（命中回收，对象池管理）
   - 简易元素克制系数表与伤害计算

## 本次对话结论
- 以本文档为当前唯一“需求真相来源”。
- 下一步：如无异议，将开始落地 Docs 目录与最小核心框架脚手架；同时提交元素克制与路径 JSON 的草案 Schema 供确认。

---
文档维护者：项目客户端负责人
更新时间：2025-08-20
